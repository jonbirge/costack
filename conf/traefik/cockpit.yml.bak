# Traefik dynamic configuration
http:     
  routers:
    cockpit:
      entryPoints:
        - websecure
      rule: "Host(`nyc.birgefuller.com`) && PathPrefix(`/cockpit`)"
      service: cockpit
      tls:
        certResolver: stackresolver
      middlewares:
        - strip-cockpit

  services:
    cockpit:
      loadBalancer:
        servers:
          - url: "http://localhost:9090/" # Adjust URL if necessary

  middlewares:
    strip-cockpit:
      stripPrefix:
        prefixes:
          - "/cockpit/"
    usonly:
      plugin:
        geoblock:
          api: "https://get.geojs.io/v1/ip/country/{ip}"
          cacheSize: 8
          silentStartUp: false
          allowLocalRequests: true
          logLocalRequests: false
          logAllowedRequests: false
          logApiRequests: false
          forceMonthlyUpdate: true
          blackListMode: false
          countries:
            - US
    topten:
      plugin:
        geoblock:
          api: "https://get.geojs.io/v1/ip/country/{ip}"
          cacheSize: 10
          silentStartUp: false
          allowLocalRequests: true
          logLocalRequests: false
          logAllowedRequests: false
          logApiRequests: false
          blackListMode: true
          forceMonthlyUpdate: true
          countries:
            - CH
            - RU
            - RO
            - BR
            - IN
            - IR
            - VN
            - TR
            - TH
            - ID
